Noverse Bug Reporting Template
==============================

Title: smithyEffect() produces incorrect handCount, and deckCount values.   

Class: Unit test failure

Date: 29 May 2019          
Reported By: Daniel Green  
Email: greendan@oregonstate.edu     

Product: Dominion               Version: assignment-2
Platform: Ubuntu 18.04.2 LTS, Linux 4.15.0-50-generic
Compiler: gcc version 7.4.0

Is it reproducible: Yes

Description
===========
The unit test cardtest2 tests smithyEffect() as defined in dominion.c. It checks for a variety of correct values, and upon execution it detected two failures in testSmithy().
After the card is played, the number of cards in the players hand is incorrect and the number of cards in the players deck is also incorrect. 

unit test debug output:
*** cardtest2 failed at handCnt, incorrect num of cards in players hand
*** cardtest2 failed at deckCnt, incorrect num of cards in players deck
==== testSmithyCard() failed.
Set CARDTEST2_DEBUG to 1 for debug info
Function 'updateCoins'
Lines executed:81.82% of 11
Branches executed:100.00% of 8
Taken at le

Steps to Produce/Reproduce
--------------------------
/bin/sh make cardtests
This compiles dominion.c without linkage and causes the compiler warning.


Expected Results
----------------
Makefile recipe printed to stdout without warnings or errors.


Actual Results
--------------
Two seperate warnings, instructing the user that both parameters of drawCard() in villageEffect() are being passed as incompatible types.


Workarounds
-----------
Gcc reports them as warnings so the compilation is successful. Undefined behaviour may occur if the villageEffect() function is called. So a workaround is to simply not use villageEffect(). 


Attachments
-----------
see bugreport2_gccWarning


Other Information
-----------
This bug was found as a result of testing a different card function. It is worth submitting a bug report because it could cause program failure in other use cases.


fix
-----------
The warnings produced by gcc were sufficient to know exactly where the bug could be found. The definition of villageEffect() in dominion.c calls drawCard(), so I swapped the two parameters to drawCard() and the warnings were seen no more. 